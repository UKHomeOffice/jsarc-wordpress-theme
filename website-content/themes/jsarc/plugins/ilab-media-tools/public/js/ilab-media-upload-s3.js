var ilabMediaS3Uploader=function(a,e,t){this.start=function(){var o=t.type;"application/x-photoshop"==o&&(o="image/psd");var p={action:"ilab_upload_prepare",filename:t.name,type:o};a.post(ajaxurl,p,function(p){if("ready"==p.status){e.updateStatusText("Uploading ...");var r=new FormData;_.each(Object.keys(p.formData),function(a){"key"!=a&&r.append(a,p.formData[a])}),null!=p.cacheControl&&p.cacheControl.length>0&&r.append("Cache-Control",p.cacheControl),null!=p.expires&&r.append("Expires",p.expires),r.append("Content-Type",o),r.append("acl",p.acl),r.append("key",p.key),r.append("file",t),a.ajax({url:p.url,method:"POST",contentType:!1,processData:!1,data:r,xhr:function(){var t=a.ajaxSettings.xhr();return t.upload.onprogress=function(a){e.updateProgress(a.loaded/a.total)},t},success:function(t){var o={action:"ilab_upload_import_cloud_file",key:p.key};a.post(ajaxurl,o,function(a){e.itemUploaded("success"==a.status,a)})},error:function(a){e.itemUploadError()}})}else e.itemUploadError()})}};ilabMediaUploadItem.prototype.storageUploader=ilabMediaS3Uploader;